apply from: "$rootDir/gradle/osgi.gradle"

dependencies {
    compile project( ':core:core-api' )
    compile ("org.elasticsearch.client:elasticsearch-rest-high-level-client:${elasticsearchVersion}") {
        exclude group: 'com.fasterxml.jackson.dataformat', module: 'jackson-dataformat-cbor'
        exclude group: 'com.fasterxml.jackson.dataformat', module: 'jackson-dataformat-yaml'
        exclude group: 'org.yaml', module: 'snakeyaml'
        exclude group: 'com.fasterxml.jackson.dataformat', module: 'jackson-dataformat-smile'
    }
    runtimeOnly "com.fasterxml.jackson.dataformat:jackson-dataformat-smile:${jacksonVersion}"
    runtimeOnly "com.fasterxml.jackson.dataformat:jackson-dataformat-cbor:${jacksonVersion}"
    runtimeOnly "com.fasterxml.jackson.dataformat:jackson-dataformat-yaml:${jacksonVersion}"
    runtimeOnly "org.apache.logging.log4j:log4j-to-slf4j:${log4jToSlf4jVersion}"

    compile 'org.apache.commons:commons-compress:1.19'

    testCompile 'org.rauschig:jarchivelib:1.0.0'
    testCompile project( path: ':core:core-blobstore', configuration: 'testOutput' )
    testCompile project( path: ':core:core-api', configuration: 'testOutput' )
}

jar {
    bnd( 'Bundle-Name': 'Enonic XP Core - Repo' )

    //Temporary export until refactoring
    bnd( 'Export-Package': 'com.enonic.xp.repo.impl.branch;-split-package:=first' )
}
