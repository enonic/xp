<html>
<head>
    <title>HTML Templates - Change Password Form</title>
    <link rel="stylesheet" type="text/css" href="../../resources/lib/ext/resources/css/ext-all.css">
    <link rel="stylesheet" type="text/css" href="../../resources/css/main.css">
    <link rel="stylesheet" type="text/css" href="css/generic.css">
    <link rel="stylesheet" type="text/css" href="css/generic-user-info.css">
    <link rel="stylesheet" type="text/css" href="css/change-password-form.css">

    <script type="text/javascript" src="../../resources/lib/ext/ext-all.js"></script>

    <script type="text/javascript">
        function showChangePasswordWindow()
        {
            var tpl = document.getElementById('tpl1').innerHTML;
            Ext.create('Ext.window.Window', {
                title: 'Change Password',
                width: 350,
                plain: true,
                modal: true,
                items: [
                    {
                        bodyPadding: 10,
                        border: false,
                        html: new Ext.XTemplate( tpl ).apply( {displayName: 'Morten Eriksen', qualifiedName: 'enonic\\mer', email: 'mer@enonic.com'} )
                    },
                    {
                        xtype: 'form',
                        id: 'userChangePasswordForm',
                        method: 'POST',
                        url: 'data/user/changepassword',
                        bodyPadding: '0 10 10 10',
                        bodyCls: 'admin-no-border',
                        layout: 'anchor',
                        defaults: {
                            xtype: 'textfield',
                            anchor: '100%',
                            inputType: 'password',
                            allowBlank: false
                        },
                        items: [{
                            fieldLabel: 'New Password',
                            name: 'cpw_password',
                            id: 'cpw_password',
                            allowBlank: false
                        },{
                            fieldLabel: 'Confirm Password',
                            name: 'cpw_password2',
                            submitValue: false,
                            allowBlank: false
                        }]
                    }
                ],
                buttons: [
                    {
                        text: 'Cancel',
                        handler: function() {
                            this.up('window').close();
                        }
                    },
                    {
                        text: 'Change Password',
                        disabled: true,
                        handler: function() {
                            var form = Ext.getCmp( 'userChangePasswordForm' ).getForm();
                            if ( form.isValid() )
                            {
                                form.submit();
                            }
                        }
                    }
                ],
                listeners: {
                    afterrender: function() {
                        Ext.getCmp('cpw_password').focus();
                    }
                }
            }).show();
        }

    </script>

</head>
<body>
<div id="tpl1">

    <!-- Template START -->
    <div class="admin-change-password-form">
        <div class="admin-user-info clearfix">
            <div class="admin-user-photo admin-left">
                <img alt="User" src="../../resources/images/x-user.png"/>
            </div>
            <div class="admin-left">
                {displayName}<br/>
                ({qualifiedName})<br/>
                <a href="mailto:{email}">{email}</a>
            </div>
        </div>

        <!--div class="clearfix">
            <div class="clearfix" style="margin-bottom: 4px">
                <label for="password" style="width: 110px">New Password:</label>
                <input type="password" name="password" id="password" class="x-form-field x-form-text" style="width:208px"/>
            </div>
            <!--div class="clearfix">
                <label for="password2" style="width: 110px">Confirm Password:</label>
                <input type="password" name="password2" id="password2" class="x-form-field x-form-text" style="width:208px"/>
            </div>
        </div-->
    </div>
    <!-- Template END -->

</div>
<p class="clearfix" style="margin-top: 10px">
    <input type="button" onclick="showChangePasswordWindow();" value="Show in Window"/>
</p>
</body>
</html>
