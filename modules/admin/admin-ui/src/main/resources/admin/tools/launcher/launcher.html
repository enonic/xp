<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <style type="text/css">
        html,body { height: 100%; margin: 0px; padding: 0px; }
    </style>
</head>
<body>

<script type="text/javascript">
(function () {
    var launcherMainContainer;

    function listenToKeyboardEvents() {
        window.addEventListener("keydown", onKeyPressed, true);
    }

    function listenToMouseMove() {
        window.addEventListener("mousemove", disableKeyboardNavigation, true);
    }

    function disableKeyboardNavigation() {
        getLauncherMainContainer().classList.remove("keyboard-navigation");
        unselectCurrentApp();
        window.removeEventListener("mousemove", disableKeyboardNavigation, true);
    }

    function initKeyboardNavigation() {
        var appContainer = getLauncherMainContainer();
        if (!appContainer.classList.contains("keyboard-navigation")) {
            listenToMouseMove();
            appContainer.classList.add("keyboard-navigation");
        }
    }

    function onKeyPressed(e) {
        if (getLauncherMainContainer().getAttribute("hidden")) {
            return;
        }

        switch(e.keyCode) {
        case 38:
            // up key pressed
            initKeyboardNavigation();
            selectPreviousApp();
            break;
        case 40:
            // down key pressed
            initKeyboardNavigation();
            selectNextApp();
            break;
        case 13:
            // enter key pressed
            var selectedApp = getSelectedApp();
            if (selectedApp) {
                startApp(selectedApp);
            }
            break;
        }
    }

    function getSelectedApp() {
        return getLauncherMainContainer().querySelector('.app-row.selected');
    }

    function getSelectedAppIndex() {
        var apps = getLauncherMainContainer().querySelectorAll('.app-row');
        for (var i=0; i<apps.length; i++) {
            if (apps[i].classList.contains("selected")) {
                return i;
            }
        }
        return -1;
    }

    function selectNextApp() {
        var selectedIndex = getSelectedAppIndex();
        var apps = getLauncherMainContainer().querySelectorAll('.app-row');

        selectApp((selectedIndex + 1) == apps.length ? 0 : selectedIndex + 1);
    }

    function selectPreviousApp() {
        var selectedIndex = getSelectedAppIndex();
        var nextIndex;
        if (selectedIndex == -1) {
            nextIndex = 0;
        }
        else if (selectedIndex == 0) {
            nextIndex = document.querySelectorAll('.app-row').length - 1;
        }
        else {
            nextIndex = selectedIndex - 1;
        }

        selectApp(nextIndex);
    }

    function selectApp(index) {
        unselectCurrentApp();
        getAppByIndex(index).classList.add("selected");
    }

    function unselectCurrentApp() {
        var selectedApp = getSelectedApp();
        if (selectedApp) {
            selectedApp.classList.remove("selected");
        }
    }

    function getAppByIndex(index) {
        var apps = getLauncherMainContainer().querySelectorAll('.app-row');
        for (var i=0; i<apps.length; i++) {
            if (i == index) {
                return apps[i];
            }
        }
        return null;
    }

    function startApp(app) {
        var anchorEl = app.parentElement;
        if (anchorEl && anchorEl.tagName == 'A' && anchorEl.click) {
            unselectCurrentApp();
            anchorEl.click();
        }
    }

    function getLauncherMainContainer() {
        if (!launcherMainContainer) {
            launcherMainContainer = document.querySelector('.launcher-main-container');
        }

        return launcherMainContainer;
    }

    listenToKeyboardEvents();
}());
</script>

<div class="launcher-main-container" tabindex="100">
    <link rel="stylesheet" type="text/css" href="{{launcherCss}}">

    <div class="launcher-tip"><span>Start here</span></div>
    <div class="launcher-title">
        <span class="container-title">{{installation}}</span>
    </div>

    <div class="launcher-app-container">
        <div class="scrollable-content">
            <a href="{{homeUrl}}" target="_blank">
                <div class="app-row" id="home">
                    <div class="app-icon">
                        <svg width="103px" height="137px" viewBox="0 0 103 137" xmlns="http://www.w3.org/2000/svg">
                            <path d="M51.0601526,136.449096 C81.5839818,118.800544 102.120305,85.814071 102.120305,48.0334 C102.120305,34.3670048 99.4331589,21.3279231 94.5581607,9.41520809 C81.5154691,3.37246198 66.9821953,0 51.6608603,0 C35.7550523,0 20.698578,3.63467269 7.27745518,10.1183798 C2.58263604,21.8403188 0,34.6354016 0,48.0334 C0,85.814071 20.5363234,118.800544 51.0601526,136.449096 L51.0601526,136.449096 Z" id="Oval-1-Copy-5" fill="#FF4D39"></path>
                            <path d="M51.5392686,122.360291 C75.6201867,108.217163 91.7850163,82.0556042 91.7850163,52.1203707 C91.7850163,41.220245 89.641786,30.8204558 85.7535556,21.3190408 C75.3508871,16.499431 63.7593512,13.8096025 51.5392686,13.8096025 L51.5392686,122.360291 L51.5392686,122.360291 Z" id="Oval-1-Copy-6" fill="#F9796A"></path>
                            <path d="M16.0436702,84.9379886 L25.9271052,62.5442921 C26.0584471,62.2378275 26.1241172,62.00251 26.1241172,61.8383325 C26.1241172,61.674155 26.0584471,61.4169475 25.9271052,61.0667022 L17.1929068,41.6281856 C16.9740035,41.124708 16.9849485,40.6814354 17.2257422,40.2983546 C17.4665358,39.9152739 17.8058308,39.7237363 18.2436375,39.7237363 L25.8614345,39.7237363 C26.4086928,39.7237363 26.8355478,40.0630314 27.1420124,40.7416316 L32.7240189,54.6638124 C32.8115802,54.8827157 32.9429202,54.9921657 33.1180429,54.9921657 C33.2931655,54.9921657 33.4245055,54.8827157 33.5120669,54.6638124 L39.0940733,40.7416316 C39.4005379,40.0630314 39.827393,39.7237363 40.3746513,39.7237363 L47.9924483,39.7237363 C48.4302549,39.7237363 48.7750225,39.9152739 49.0267613,40.2983546 C49.2785001,40.6814354 49.2839726,41.124708 49.0431789,41.6281856 L40.3089806,61.1323728 C40.1776386,61.4826181 40.1119686,61.7343532 40.1119686,61.8875855 C40.1119686,62.0408178 40.1776386,62.2816078 40.3089806,62.6099628 L50.1924156,84.9379886 C50.3018672,85.1787822 50.3565922,85.4086272 50.3565922,85.6275306 C50.3565922,85.8683242 50.2909222,86.0762792 50.1595802,86.2514019 C49.9187866,86.6235375 49.5685465,86.8096025 49.1088496,86.8096025 L41.1955346,86.8096025 C40.4731536,86.8096025 40.0025186,86.4703075 39.7836153,85.7917072 L33.5120669,69.8665712 C33.4245055,69.6476679 33.2931655,69.5382178 33.1180429,69.5382178 C32.9429202,69.5382178 32.8115802,69.6476679 32.7240189,69.8665712 L26.4524705,85.7917072 C26.2335672,86.4703075 25.7629321,86.8096025 25.0405512,86.8096025 L17.1272362,86.8096025 C16.6894296,86.8096025 16.3391895,86.6125925 16.0765055,86.2185665 C15.9451636,86.0215536 15.8794935,85.8026535 15.8794935,85.5618599 C15.8794935,85.3648469 15.9342186,85.1568919 16.0436702,84.9379886 L16.0436702,84.9379886 L16.0436702,84.9379886 Z M55.7087513,85.4633539 L55.7087513,41.069985 C55.7087513,40.7197397 55.8455639,40.4078071 56.119193,40.134178 C56.3928221,39.8605489 56.7047547,39.7237363 57.055,39.7237363 L71.8637347,39.7237363 C73.7900838,39.7237363 75.6124265,40.0958664 77.3308175,40.8401376 C79.0492085,41.5844089 80.5486736,42.5968215 81.829258,43.8774058 C83.1098423,45.1579902 84.122255,46.6574554 84.8665262,48.3758463 C85.6107975,50.0942373 85.9829275,51.91658 85.9829275,53.8429291 C85.9829275,55.8130589 85.6107975,57.6518191 84.8665262,59.3592649 C84.122255,61.0667107 83.1098423,62.5607034 81.829258,63.8412877 C80.5486736,65.1218721 79.0492085,66.1342847 77.3308175,66.878556 C75.6124265,67.6228272 73.7900838,67.9949572 71.8637347,67.9949572 L65.7891983,67.9949572 C65.3513917,67.9949572 65.1324916,68.2138573 65.1324916,68.6516639 L65.1324916,85.4633539 C65.1324916,85.8135992 64.9956791,86.1255317 64.72205,86.3991609 C64.4484209,86.67279 64.1364883,86.8096025 63.786243,86.8096025 L57.055,86.8096025 C56.7047547,86.8096025 56.3928221,86.67279 56.119193,86.3991609 C55.8455639,86.1255317 55.7087513,85.8135992 55.7087513,85.4633539 L55.7087513,85.4633539 L55.7087513,85.4633539 Z M65.1324916,57.881675 C65.1324916,58.3194816 65.3513917,58.5493266 65.7891983,58.5712169 L71.8637347,58.5712169 C73.1552642,58.5712169 74.2607094,58.1115269 75.1801032,57.192133 C76.0994971,56.2727391 76.5591872,55.156349 76.5591872,53.8429291 C76.5591872,52.5513996 76.0994971,51.4459545 75.1801032,50.5265606 C74.2607094,49.6071667 73.1552642,49.1474766 71.8637347,49.1474766 L65.7891983,49.1474766 C65.3513917,49.1474766 65.1324916,49.3773217 65.1324916,49.8370186 L65.1324916,57.881675 L65.1324916,57.881675 Z" id="XP" fill="#FFFFFF"></path>
                            <path d="M6.0070764,130.297446 C33.6095562,114.086046 52.1383092,84.0986547 52.1383092,49.7857321 C52.1383092,37.2915864 49.6816557,25.3709456 45.2248156,14.4800563 C33.3008746,8.95563312 20.0142078,5.87244762 6.0070764,5.87244762 L6.0070764,130.297446 L6.0070764,130.297446 Z" id="Oval-1-Copy-7" opacity="0.150944496" fill="#FF4D39" transform="translate(29.072693, 68.084947) scale(-1, 1) translate(-29.072693, -68.084947) "></path>
                        </svg>
                    </div>
                    <div class="app-info">
                        <p class="app-name">Home</p>
                        <p class="app-description">Start page for Enonic XP</p>
                    </div>
                </div>
            </a>
            {{#adminTools}}
            <a href="{{uri}}" target="_blank">
                <div class="app-row" id="{{appId}}">
                    <div class="app-icon">{{#icon}}{{{icon}}}{{/icon}}</div>
                    <div class="app-info">
                        <p class="app-name">{{displayName}}</p>
                        <p class="app-description">{{#description}}{{description}}{{/description}}</p>
                    </div>
                </div>
            </a>
            {{/adminTools}}
        </div>

    </div>

    <div class="launcher-user">
        <div class="user-info">
            <img src="{{userIconUrl}}">
            <span>{{user.displayName}}</span>
        </div>
        <div class="user-logout">
            <a href="{{logoutUrl}}">Log out</a>
        </div>
    </div>

</div>
</body>
</html>
