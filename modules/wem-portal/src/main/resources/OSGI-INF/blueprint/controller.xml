<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">

  <reference-list id="postProcessInjections" interface="com.enonic.wem.portal.postprocess.PostProcessInjection"
                  availability="optional"/>

  <reference-list id="postProcessInstructions" interface="com.enonic.wem.portal.postprocess.PostProcessInstruction"
                  availability="optional"/>

  <bean id="postProcessor" class="com.enonic.wem.portal.internal.postprocess.PostProcessorImpl">
    <property name="injections" ref="postProcessInjections"/>
    <property name="instructions" ref="postProcessInstructions"/>
  </bean>

  <bean id="controllerFactory" class="com.enonic.wem.portal.internal.controller.JsControllerFactoryImpl">
    <property name="scriptService" ref="scriptService"/>
    <property name="postProcessor" ref="postProcessor"/>
  </bean>

  <service auto-export="interfaces">
    <bean class="com.enonic.wem.portal.internal.postprocess.injection.LiveEditInjection"/>
  </service>

  <service auto-export="interfaces">
    <bean class="com.enonic.wem.portal.internal.postprocess.instruction.ComponentInstruction">
      <argument index="0" ref="rendererFactory"/>
      <argument index="1" ref="pageComponentService"/>
    </bean>
  </service>

</blueprint>
